{% extends "base.html" %}

{% block title %}All Lessons - Educational Platform{% endblock %}

{% block content %}
    <h1>All Lessons</h1>
    {% if current_user.is_authenticated %}
        <a href="{{ url_for('create_lesson') }}" class="btn btn-primary">Create New Lesson</a>
    {% endif %}
    {% if lessons %}
        <ul>
        {% for lesson in lessons %}
            <li>
                <strong>{{ lesson.title }}</strong> 
                (Course: <a href="{{ url_for('course_details', course_id=lesson.course_id) }}">{{ courses[lesson.course_id].title }}</a>)
                - Order: {{ lesson.order }}
                <a href="{{ url_for('lesson_details', course_id=lesson.course_id, lesson_id=lesson.id) }}">View Lesson</a>
                {% if current_user.is_authenticated and (current_user.id == courses[lesson.course_id].instructor_id or current_user.is_admin) %}
                    <a href="{{ url_for('edit_lesson', course_id=lesson.course_id, lesson_id=lesson.id) }}" class="btn btn-secondary btn-sm">Edit</a>
                    <form action="{{ url_for('delete_lesson', course_id=lesson.course_id, lesson_id=lesson.id) }}" method="POST" style="display: inline;">
                        <input type="submit" value="Delete" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure you want to delete this lesson?');">
                    </form>
                {% endif %}
            </li>
        {% endfor %}
        </ul>
    {% else %}
        <p>No lessons available at the moment.</p>
    {% endif %}
{% endblock %}
